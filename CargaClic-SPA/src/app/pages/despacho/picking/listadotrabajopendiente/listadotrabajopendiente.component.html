
<div class="page-head">
    <h2 class="page-head-title">Lista de Trabajos</h2>
    <nav aria-label="breadcrumb" role="navigation">
      <ol class="breadcrumb page-head-nav">
        <li class="breadcrumb-item"><a href="#">Trabajos pendientes</a></li>
        <!-- <li class="breadcrumb-item">Listado de Órdenes de Recibo</li>
        <li class="breadcrumb-item active">Identificar Pallets</li> -->
      </ol>
    </nav>
  </div>
  
  <div class="main-content container-fluid">
  
      <div class="col-md-12">
      <div class="card card-border-color card-border-color-danger">
          <div class="card-header">
                    <b> Filtro de búsqueda  </b>  
              </div>
          <div class="card-body">
              <div class="row">
            
                           
                <div class="col-md-3">
                  <h5>Propietario :</h5>
                  <p-dropdown  [options]="clientes"  [(ngModel)]="model.PropietarioId" 
                  scrollHeight="40vh" class="input-form-field  col-sm-5"    [style]="{'width':'100%'}" [autoWidth]="false" [resetFilterOnHide]="false" 
                  [hideTransitionOptions]="'0ms'"
                  [showTransitionOptions]="'0ms'" 
                  placeholder="seleccione un cliente"  
                  filter="true">
                      <ng-template let-item pTemplate="selectedItem">
                          <span style="vertical-align:left;">{{item.label}}</span>
                      </ng-template>
                      <!-- <ng-template let-item pTemplate="item">
                        <div class="ui-helper-clearfix" style="position: relative;height: 25px;">
                            <div style="font-size:14px;float:left;margin-top:4px">{{item.label}}</div>
                        </div>
                    </ng-template> -->
                    </p-dropdown>
                  </div>
                  <div class="col-md-3 offset-md-2">
                     <button class="btn btn-block btn-danger"  (click)="buscar()"  type="button">Buscar</button>
                  </div>
               
                </div>
          </div>
      </div>
  
    </div>
  <div class="col-md-12">
  
  
    <div class="card card-border-color card-border-color-danger">
        <div class="card-header">
            <div  [hidden]="!checkSelects()">
                   <b> Trabajos    </b>  <span class="card-subtitle">   Listado de trabajos del sistema</span>
                </div>
                <div  [hidden]="checkSelects()" >
                    <b> Cargas seleccionadas  :  {{selection.selected.length}} </b>  <span class="card-subtitle">   Listado de cargas del sistema</span>
                </div>
            </div>
        
      <div class="card-body">
          <div class="row">
              <div class="col-md-3">
                  <button class="btn btn-block btn-warning" ngbTooltip="Asignar area de despacho"  (click)="asignarPuerta()"  type="button">Área despacho </button>  
              </div>
              <div class="col-md-3">
                  <button class="btn btn-block btn-primary" ngbTooltip="Asignar Trabajador"  (click)="asignarTrabajador()"  type="button">Asignar Trabajador </button>  
              </div>
  
              <!-- <div  class="col-md-4 offset-md-2" >
                  <div class="input-container">
                      <i class="fa fa-search"></i>
                      <mat-form-field class="search-form-field" >
                        <input matInput [(ngModel)]="searchKey" placeholder="Filtrar..." autocomplete="off" (keyup)="applyFilter()">
                      </mat-form-field>
                      </div>
                </div> -->
          </div>
          <div  class="example-container">
              <!-- <mat-table #table [dataSource] = "listData" matSort >
               
             
  
                 <ng-container matColumnDef="workNum" sticky>
                  <mat-header-cell *matHeaderCellDef mat-sort-header> N° Trabajo</mat-header-cell>
                  <mat-cell  *matCellDef="let orden" > 
                      
                        <span class="label label-info pull-xs-center">{{orden.workNum}}</span>
                      
              
                  </mat-cell>
                </ng-container>
          
            
                  <ng-container matColumnDef="propietario" >
                      <mat-header-cell *matHeaderCellDef mat-sort-header >  Propietario </mat-header-cell>
                      <mat-cell *matCellDef="let user"> {{user.propietario}} </mat-cell>
                    </ng-container>
            
                    <ng-container matColumnDef="FechaRegistro">
                        <mat-header-cell *matHeaderCellDef mat-sort-header> Fecha Registro</mat-header-cell>
                        <mat-cell *matCellDef="let user"> 
                            {{user.fechaRegistro | date:'dd-MM-yyyy' }} 
                        </mat-cell>
                      </ng-container>
                      <ng-container matColumnDef="FechaAsignacion">
                        <mat-header-cell *matHeaderCellDef mat-sort-header> Fecha Asignacion</mat-header-cell>
                        <mat-cell *matCellDef="let user"> 
                            {{user.fechaAsignacion | date:'dd-MM-yyyy' }} 
                        </mat-cell>
                      </ng-container>
                      <ng-container matColumnDef="FechaTermino">
                        <mat-header-cell *matHeaderCellDef mat-sort-header> Fecha Término</mat-header-cell>
                        <mat-cell *matCellDef="let user"> 
                            {{user.fechaTermino | date:'dd-MM-yyyy' }} 
                        </mat-cell>
                      </ng-container>
            
                    <ng-container matColumnDef="CantidadLPN">
                          <mat-header-cell *matHeaderCellDef mat-sort-header >  # Pallets </mat-header-cell>
                          <mat-cell *matCellDef="let user"> {{user.cantidadLPN}} </mat-cell>
                        </ng-container>

                    <ng-container matColumnDef="cantidadTotal">
                        <mat-header-cell *matHeaderCellDef mat-sort-header >  # Productos </mat-header-cell>
                        <mat-cell *matCellDef="let user"> {{user.cantidadTotal}} </mat-cell>
                      </ng-container>

                          
                  <ng-container matColumnDef="Estado">
                        <mat-header-cell *matHeaderCellDef mat-sort-header> Estado  </mat-header-cell>
                        <mat-cell *matCellDef="let user"> 
  
                      <div *ngIf="user.estado == 'Planeado' then thenBlock else elseBlock"></div>
                      <ng-template #thenBlock>  <div  [style.color]="'#FFFFFF'" [style.background-color]="'#0c9811'">{{user.estado}}     </div>     </ng-template>
                      <ng-template #elseBlock>   <div>{{user.estado}}     </div>   </ng-template>  
                        </mat-cell>
                  </ng-container>
  
          
                  <ng-container matColumnDef="ubicacion">
                    <mat-header-cell *matHeaderCellDef mat-sort-header >  Destino </mat-header-cell>
                    <mat-cell *matCellDef="let user"> {{user.ubicacion}} </mat-cell>
                  </ng-container>

 

                     <ng-container matColumnDef="Direccion">
                        <mat-header-cell *matHeaderCellDef mat-sort-header >  Direccion </mat-header-cell>
                        <mat-cell *matCellDef="let user"> {{user.direccion}} </mat-cell>
                      </ng-container>
                   
  

              <mat-header-row *matHeaderRowDef="displayedColumns; " ></mat-header-row>
              <mat-row *matRowDef="let row; columns: displayedColumns;" 
              
              [ngClass]="{ 'highlight': selectedRowIndex == row.id}"
               (click)="highlight(row)"> 
  
              </mat-row>
            
            
              </mat-table>
   -->
  
   <p-table [style]="{width:'100%'}"
   [scrollable]="true" [columns]="cols" [value]="cargas"
   [(selection)]="selectedRow"  #dt [paginator]="true"  
   [rows]="40" [resizableColumns]="true" selectionMode="multiple" [responsive]="true"  >
    >

     <ng-template pTemplate="colgroup" let-columns>
        <colgroup>
            <col *ngFor="let col of columns"   [ngStyle]="{'width': col.width}" >
        </colgroup>
     </ng-template>

      <ng-template pTemplate="header" let-columns>
        <tr>
            <th  [ngStyle]="{'width': col.width}" *ngFor="let col of columns" pResizableColumn [pSortableColumn]="col.field">
                {{col.header}}
                <p-sortIcon [field]="col.field" ariaLabel="Activate to sort" ariaLabelDesc="Activate to sort in descending order" ariaLabelAsc="Activate to sort in ascending order"></p-sortIcon>
            </th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-rowData let-columns="columns">
      <tr  [pSelectableRow]="rowData">
          <!-- <td class="ui-resizable-column">  
            <div class="ui-inputgroup">
              <button  class="ui-button-secondary" ngbTooltip="Editar Orden" (click)="edit(rowData.ordenSalidaId)" type="button"><i class="fa fa-edit"></i></button>
              <button  class="ui-button-secondary" ngbTooltip="Eliminar Orden" [swal]="deleteSwal" (confirm)="delete(rowData.ordenSalidaId)"  [disabled]="rowData.nombreEstado != 'Planeado'"  type="button"><i class="fa fa-trash"></i></button>
              <button  class="ui-button-secondary" (click)="ver(rowData.ordenSalidaId)" type="button"><i class="fa  fa-search"></i></button>
            </div>
        </td> -->
          <td class="ui-resizable-column"> {{rowData.almacen  }}</td>
          <td class="ui-resizable-column"> {{rowData.workNum  }}</td>
          <td class="ui-resizable-column"> {{rowData.propietario}} </td>
          <td class="ui-resizable-column"> {{rowData.ubicacion}} </td> 
          <td class="ui-resizable-column"> {{rowData.fechaAsignacion | date: 'dd/MM/yyyy' }} </td>
          <td class="ui-resizable-column"> {{rowData.fechaTermino  | date: 'dd/MM/yyyy' }} </td>
          <td class="ui-resizable-column"> {{rowData.cantidadLPN  }} </td>
          <td class="ui-resizable-column"> {{rowData.cantidadTotal  }} </td>
          <td  [ngClass]="rowData.estado == 'Almacenado' ? 'old-car' :  (rowData.estado == 'Asignado'?'very-old-car': null) "> {{rowData.estado}}</td>
          
          
          
      </tr>
      </ng-template>




   </p-table>
  
            </div>
          
      </div>
     
    </div>
  </div>
  
  
  </div>
  
  <swal
    #deleteSwal
    title="Eliminar la Orden"
    text="¿Esta seguro que desea eliminar la orden?"
    type="question"
    [showCancelButton]="true"
    [focusCancel]="true"
    [options]="{ confirmButtonText: 'Elminar' }"
    >
  </swal>
  
  <ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '3px' }" ></ngx-loading>
  
  <!-- <mat-progress-bar
            class="example-margin"
            [color]="color"
            [mode]="indeterminate"
            [value]="value"
            [bufferValue]="bufferValue">
  </mat-progress-bar> -->
  